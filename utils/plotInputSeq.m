%%PLot input sequences
% load or run options for running this function
if exist('optionsFile.mat','file')==2
    load('optionsFile.mat');
else
    optionsFile = runOptions();
end

%% Study 1: UCMS ABA_R
% Y1 = readmatrix("C:\Users\c3200098\Desktop\projects\IDMIM\utils\inputSequences\2023_UCMS\NJB_HGF_ABA2_R.txt");
% Y2 = [0.8*ones(1,60),0.5*ones(1,10),0.65*ones(1,5),0.3*ones(1,8),0.45*ones(1,12),...
%         0.75*ones(1,6),0.55*ones(1,11),0.25*ones(1,8),0.8*ones(1,60)];
% currTask = optionsFile.cohort(1).testTask(1).name;

%% Study 2 & 3: 
% TrainingTask_RL
% Y1 = readmatrix("C:\Users\c3200098\Desktop\projects\IDMIM\utils\inputSequences\2024_HGFPilot\NJB_HGF_TrainingTask_RL.txt");
% Y2 = [0.8*ones(1,140),0.2*ones(1,140)]; TrainingTask_RL
% currTask = optionsFile.cohort(2).trainTask(1).name;

%TestTask A
Y1 = readmatrix("C:\Users\c3200098\Desktop\projects\IDMIM\utils\inputSequences\2024_HGFPilot\NJB_HGF_TestTaskA.txt");
Y2 = [0.8*ones(1,40),0.3*ones(1,20),0.7*ones(1,20),0.2*ones(1,40),0.7*ones(1,20),...
         0.3*ones(1,20),0.8*ones(1,40),0.3*ones(1,20),0.7*ones(1,20),0.2*ones(1,40)];
currTask = optionsFile.cohort(2).testTask(1).name;
            


% Create figure
figure1 = figure('WindowState','maximized','Color',[1 1 1]);

% Create axes
axes1 = axes('Parent',figure1);
hold(axes1,'on');

% Create plot
plot(Y1,'SeriesIndex',1,'DisplayName','Rewarding lever',...
    'MarkerFaceColor',[0 0.447058823529412 0.741176470588235],...
    'MarkerEdgeColor',[0 0.447058823529412 0.741176470588235],...
    'MarkerSize',20,...
    'Marker','|',...
    'LineWidth',1.4,...
    'LineStyle','none');

% Create stairs
stairs(Y2,'DisplayName','Reward probability','LineWidth',2,'LineStyle','-.',...
    'Color',[1 0 0]);

% Create ylabel
ylabel('Reward probability (%)','FontName','Arial');

% Create xlabel
xlabel('Trial','FontName','Arial');

% Create title
title('Task structure of TestTask A');

% Uncomment the following line to preserve the X-limits of the axes
xlim(axes1,[-10 290]);
% Uncomment the following line to preserve the Y-limits of the axes
ylim(axes1,[-0.1 1.1]);
hold(axes1,'off');
% Set the remaining axes properties
set(axes1,'ClippingStyle','rectangle','FontName','Arial','FontSize',22,...
    'GridAlpha',0.2,'GridLineStyle','--','MinorGridColor',...
    [0.149019607843137 0.149019607843137 0.149019607843137],'XGrid','on',...
    'XMinorTick','off','XTick',[0 40 80 120 160 200 240 280],'YTick',...
    [0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1]);
% Create legend
legend1 = legend(axes1,'show');
set(legend1,...
    'Position',[0.720008678314176 0.740865745627672 0.148307294410964 0.0730291592637098],...
    'FontSize',16,...
    'EdgeColor','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.155557291666667 0.897138228941682 0.0516041666666665 0.0291576673866017],...
    'Color',[0 0.447058823529412 0.741176470588235],...
    'String','Stable',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontName','Arial',...
    'FitBoxToText','off');

% Create textbox
annotation(figure1,'textbox',...
    [0.360895833333332 0.898488120950318 0.0516041666666668 0.0291576673866017],...
    'Color',[0 0.447058823529412 0.741176470588235],...
    'String','Stable',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontName','Arial',...
    'FitBoxToText','off');

% Create textbox
annotation(figure1,'textbox',...
    [0.568447916666664 0.898488120950315 0.0516041666666668 0.0291576673866017],...
    'Color',[0 0.447058823529412 0.741176470588235],...
    'String','Stable',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontName','Arial',...
    'FitBoxToText','off');

% Create textbox
annotation(figure1,'textbox',...
    [0.775739583333331 0.897948164146857 0.0516041666666668 0.0291576673866017],...
    'Color',[0 0.447058823529412 0.741176470588235],...
    'String','Stable',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontName','Arial',...
    'FitBoxToText','off');

% Create textbox
annotation(figure1,'textbox',...
    [0.464802083333332 0.903887688984873 0.0354583333333333 0.0237580993520508],...
    'Color',[0.635294117647059 0.0784313725490196 0.184313725490196],...
    'String','Volatile',...
    'LineStyle','none',...
    'FitBoxToText','off');

% Create textbox
annotation(figure1,'textbox',...
    [0.157901041666666 0.704103671706263 0.0385833333333331 0.0475161987041008],...
    'Color',[0.635294117647059 0.0784313725490196 0.184313725490196],...
    'String','0.8',...
    'LineStyle','none',...
    'FontName','Arial',...
    'FitBoxToText','off');

% Create textbox
annotation(figure1,'textbox',...
    [0.313630208333331 0.638768898488115 0.0385833333333331 0.0475161987041008],...
    'Color',[0.635294117647059 0.0784313725490196 0.184313725490196],...
    'String','0.7',...
    'LineStyle','none',...
    'FontName','Arial',...
    'FitBoxToText','off');

% Create textbox
annotation(figure1,'textbox',...
    [0.261026041666666 0.369600431965441 0.038583333333333 0.0475161987041008],...
    'Color',[0.635294117647059 0.0784313725490196 0.184313725490196],...
    'String','0.3',...
    'LineStyle','none',...
    'FontName','Arial',...
    'FitBoxToText','off');

% Create textbox
annotation(figure1,'textbox',...
    [0.366104166666663 0.303725701943835 0.0385833333333331 0.047516198704101],...
    'Color',[0.635294117647059 0.0784313725490196 0.184313725490196],...
    'String','0.2',...
    'LineStyle','none',...
    'FontName','Arial',...
    'FitBoxToText','off');

% Create textbox
annotation(figure1,'textbox',...
    [0.671963541666664 0.904967602591782 0.0354583333333333 0.0237580993520508],...
    'Color',[0.635294117647059 0.0784313725490196 0.184313725490196],...
    'String','Volatile',...
    'LineStyle','none',...
    'FitBoxToText','off');

% Create textbox
annotation(figure1,'textbox',...
    [0.259203124999999 0.903887688984875 0.0354583333333334 0.0237580993520508],...
    'Color',[0.635294117647059 0.0784313725490196 0.184313725490196],...
    'String','Volatile',...
    'LineStyle','none',...
    'FitBoxToText','off');

% Create rectangle
annotation(figure1,'rectangle',...
    [0.569401041666664 0.111231101511877 0.103645833333333 0.815604751619871],...
    'Color','none',...
    'FaceColor',[0 0.447058823529412 0.741176470588235],...
    'FaceAlpha',0.05);

% Create rectangle
annotation(figure1,'rectangle',...
    [0.775781249999997 0.111231101511877 0.103645833333333 0.815604751619871],...
    'Color','none',...
    'FaceColor',[0 0.447058823529412 0.741176470588235],...
    'FaceAlpha',0.05);

% Create rectangle
annotation(figure1,'rectangle',...
    [0.362499999999999 0.11096112311015 0.103645833333333 0.815604751619872],...
    'Color','none',...
    'FaceColor',[0 0.447058823529412 0.741176470588235],...
    'FaceAlpha',0.05);

% Create rectangle
annotation(figure1,'rectangle',...
    [0.156119793651626 0.111231104598855 0.103645833333333 0.815604751619871],...
    'Color','none',...
    'FaceColor',[0 0.447058823529412 0.741176470588235],...
    'FaceAlpha',0.05);

% Create textbox
annotation(figure1,'textbox',...
    [0.29214583333333 0.732721382289402 0.113062499999998 0.0572354211663079],...
    'String',{'Reward contingencies','change across both levers'},...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'BackgroundColor',[1 1 1]);

% Create line
annotation(figure1,'line',[0.262239583333333 0.292447916666667],...
    [0.723542116630669 0.748380129589633]);

% Save figure
savePath = fullfile([optionsFile.paths.saveDir,'results\2024_HGFPilot\plots\taskStructure']);
figdir = fullfile([savePath,filesep, currTask, '_TrajPlot']);
save([figdir,'.fig'])
print([figdir,'.png'], '-dpng')

disp(['Plot of ',currTask,' successfully saved to ',savePath,'.']);